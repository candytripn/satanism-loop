<style>
  .error { color: #ff6b6b; font-weight: bold; }
</style>

<py-script>
from pyscript import document, when
import asyncio, sys, traceback

screen = document.querySelector("#screen")
qa_row = document.querySelector("#qaRow")
text_input = document.querySelector("#textInput")

def clear():
    screen.innerHTML = ""

def print_line(s="", cls=""):
    if cls:
        line = f'<div class="{cls}">{s}</div>'
    else:
        line = f"<div>{s}</div>"
    screen.innerHTML += line
    screen.scrollTop = screen.scrollHeight

async def pause(sec): 
    await asyncio.sleep(sec)

def show_menu():
    clear()
    print_line("Just ansewr the question; It's simple!")
    print_line("1. Answer the question, it's simple.")
    print_line("2. Ask your own question")
    print_line("3. Pff, no thanks...")

def show_input(prompt):
    print_line()
    print_line(prompt)
    qa_row.style.display = "flex"
    text_input.value = ""
    text_input.focus()

@when("click", "#opt1")
def on_opt1(evt):
    clear()
    show_input("What is Satanism? ")

@when("click", "#opt2")
def on_opt2(evt):
    clear()
    show_input("Oh, you want to ask me a question? Go on then.")

@when("click", "#opt3")
async def on_opt3(evt):
    clear()
    print_line("Nothing about you is real")
    await pause(1.5)
    clear()
    print_line("You just want to be like us!")
    await pause(1.5)
    print_line("ğŸ®lolcowğŸ®")
    await pause(0.5)
    print_line(r"""
     â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„        â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„
  â–„â–ˆâ–€    â–€â–ˆâ–„    â–„â–ˆâ–€    â–€â–ˆâ–„
  â–ˆâ–€  â–„â–„â–„   â–€â–ˆ  â–ˆâ–€   â–„â–„â–„  â–€â–ˆ
â–ˆ   â–ˆ   â–ˆ   â–ˆ  â–ˆ   â–ˆ   â–ˆ   â–ˆ
â–ˆ   â–€â–„â–„â–„â–€   â–ˆ  â–ˆ   â–€â–„â–„â–„â–€   â–ˆ
  â–ˆâ–„        â–„â–ˆ  â–ˆâ–„        â–„â–ˆ
  â–€â–ˆâ–„â–„â–„â–„â–„â–„â–ˆâ–€    â–€â–ˆâ–„â–„â–„â–„â–„â–„â–ˆâ–€
""")

@when("click", "#reset")
def on_reset(evt):
    qa_row.style.display = "none"
    show_menu()

@when("click", "#submit")
async def on_submit(evt):
    try:
        last_prompt = (screen.innerText.splitlines() or [""])[-1]
        val = text_input.value.strip()
        qa_row.style.display = "none"

        if last_prompt.startswith("What is Satanism?"):
            print_line(f"LolğŸ„ You think Satanism is {val}?")
            await pause(1.2)
            clear()
            print_line("No it isn't!")
            await pause(1.0)
            print_line("ğŸ®lolcowğŸ®")
            await pause(1.0)
            show_menu()

        elif last_prompt.startswith("Oh, you want to ask me a question?"):
            if val.lower() == "what is satanism":
                print_line("What? WHAT?!?")
                await pause(0.6)
                raise Exception("ğŸ’€ Crashout! ğŸ’€")
            else:
                clear()
                print_line(f"{val}. That isn't even a real question, lolcowğŸ„")
                await pause(0.8)
                print_line("No it isn't!")
                await pause(1.0)
                show_menu()
        else:
            show_menu()

    except Exception as e:
        tb = traceback.format_exc()
        print_line(tb, cls="error")
</py-script>
